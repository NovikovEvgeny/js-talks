# Global objects

## JS Global Objects

В стандарте JS есть множество "глобальных объектов" (или "встроенных" объектов - [built-in objects](https://tc39.es/ecma262/#sec-built-in-object)) - обычно это
какие-либо стркутуры данных. Например,

* Обертки для типов данных: `Number`, `String`, `Boolean` etc
* "Классы" `Error`, `Date`
* Структуры данных `Array`, `Map`, `Set`
* Вспомогательные штуки типа `Promise`

Всё это описано в стандарте и должно работать в любой среде выполнения JS

## Node global objects 

У ноды есть свои глобальные объекты, типо `window` в браузерах. Эти объекты принадлежат ноде, а не V8, так что процесса в браузере не будет.

### console

В ноде есть класс `Console`, функционал которого похож на такой же в браузере. Конструктор позволяет определить 2 потока для записи данных: output для `.log()` и error, для варнингов и ошибок. Если стрим для ошибок и варнингов не определен - все будет уходить в output.

В общем виде глобальный объект `console` это экземпляр класса `new Console(process.stdout, process. stderr)`.

Набор методов: 

* для вывода сообщений - `.log()`, `.info()`, `.warn()`, `.error()`, `.trace()`.
* для замера времени - `.time(label)`, `.timeEnd(label)`. Лейбл уникальный для каждого замера, вызов окончания выведет результат в ms в консоль.
* для assertion test - `.assert(value[, message][, ...])`. В отличии от браузеров кинет `AssertionError` и закончит выполнение.

### process

Предоставляет информацию и контролирует текущий процесс Node.js. Как глобальный объект, он всегда доступен приложениям Node.js без необходимости вызова require().
Сам по себе процесс - экземпляр EventEmitter, так что он может бросать несколько ивентов. Все сигнальные ивенты, такие как `SIGINT`, `SIGTERM` и прочие. Удобно работать с ними когда необходимо обеспечить gracefull shutdown. Еще есть `disconnect`, `beforeExit` и `exit`. Первый управление дочерними процессами, второй генерируется когда в евентлупе больше нет задач, а третий можно вызвать через `process.exit()` либо он сгенерируется когда лупа пустая. 

Процесс хранит в себе `argc` и `argv`, где как и в других языках первый - количество переданных аргументов, второй - массив строк. На нулевом индексе - путь до ноды, на первом - путь до выполняемого файла, остальные - переданные аргументы.

Процесс имеет доступ к переменным среды. `process.env`. Их можно назначить из кода, но эффект будет только внутри процесса. Любое присваивание неявно конвертирует значение в строку.

```
process.env.test = null;
console.log(process.env.test); // 'null'
process.env.test = undefined;
console.log(process.env.test); // 'undefined'
```

И еще много проперти которые есть, но нужны в каких-то специальных кейсах.

### dash variables
Удобно, когда организовываешь работу с локальными файлами.
`__dirname` - имя каталога, в котором в данный момент находится выполняющийся скрипт.
```
node ~/project/test/example.js

example.js:

console.log(__dirname); // ~/project/test/
```
`__filename` - разрешенный путь до файла.
```
node ~/project/test/example.js

example.js:

console.log(__filename); // ~/project/test/example.js
```
### global
В отличии от бразуеров, в ноде объявление глобальных переменных, например через var, будет замкнуто на область конкретного модуля. Для того, чтобы создать и использовать глобальную, для всего процесса, переменную, мы делаем `global.varName = any` и можем обращаться к ней либо как к полю объекта global, либо только по ее имени.

### Buffer
Буфер - большая тема для обсуждения, но если коротко обозревать что он из себя представляет.

### etc
Еще, глобальными объектами будет считать ключи экспорта-импорта, такие как `module`, `require`, `exports`. О них в другой раз. И таймеры, `setTimeout`, `setInterval`, которые не отличаются от таймаутов в браузере.
